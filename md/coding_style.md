# コーディングスタイル
スタイルが統一されていないソースコードは、それだけで可読性に劣るため、
スタイルの統一は重要であるが、それにこだわりすぎれば、不毛な宗教論争が発生してしまう。
そのようなロスを避けスタイルを定めたとしても、その遵守が目視、手作業によって行われるならば、
これもまた新たなロスになる。

こういった状況に陥ることなくソースコードの記述スタイルを統一するために、
本ドキュメントでは「clang-formatを使い、デフォルトのスタイルを適切に定め、
必要なら多少のカスタマイズを行い、それに従う」ことを推奨する。

以下は、clang-formatを使えない場合のスタイルの指針である。

___

__この章の構成__

<!-- index 1-3 -->

[このドキュメントの構成](---)に戻る。  

___

## インデント
### インデント用文字
* 1インデントは、4つのスペース文字で表す
  (ハードタブはビューアにより見え方が変わるため使用しない)。

```cpp
    // @@@ example/etc/coding_style.cpp #0:0 begin
```

### if、for、while、do-whileのインデント
* if、for、while、do-whileに付随する文は、
  if、for、while、do-whileより1インデント下げる(「[ブロック(波括弧({}))](---)」等を参照)。

### ブロックのインデント
* ブロック内部の文はブロック開始の'{'より1インデント下げる。

### case、defaultのインデント
* case、defaultのインデントはswitchと合わせる。
* case、defaultに続く文のインデントは一つ下げる。 
* case、defaultの次の文は改行後に書く。
* case内をブロック化するために { ... } で囲む場合、'{'は:の後に1スペースを置き、
  その直後に配置する。'}'はcaseと同じカラムに置く。

```cpp
    // @@@ example/etc/coding_style.cpp #1:0 begin -1
```

## ブロック(波括弧({}))
* 文に続く'{'は、文の後に1スペースを置き、その直後に配置する。
* '}'の後に続く文は'}'の直後に改行を入れ、同じカラムから書き始める。
* 関数宣言に続く'{'は、関数宣言の直後に改行し、直前の行の先頭と同じカラムに '{' を配置する。

```cpp
    // @@@ example/etc/coding_style.cpp #2:0 begin
```

## 関数シグネチャ内の'()'
* 関数シグネチャ内の'('は関数名の直後に置く。
* 行が長すぎる等より関数を複数行で宣言する場合、')'は最後の仮引数の直後か、独立の行に置く。
* 全体が一行に収まるときは、そのまま一行に書く。

```cpp
    // @@@ example/etc/coding_style.cpp #3:0 begin
```

## クラスのアクセスレベル
* メンバ関数等のネストが深くなりすぎるため、クラスのアクセスレベルはインデントしない。

```cpp
    // @@@ example/etc/coding_style.cpp #4:0 begin
```

## スペース
### 文の後
* [定義] ステートメントキーワードとは、for、while、do-while、switch、try、if、else等を指す。
* ステートメントキーワードの後には1スペースを入れる。
* 関数名の直後にはスペースを入れない。

```cpp
    // @@@ example/etc/coding_style.cpp #5:0 begin -1
```

### コンマの後  
* 行最後の文字でないコンマ(,)の後には1スペースを入れる。

```cpp
    // @@@ example/etc/coding_style.cpp #6:0 begin -1
```

### 単項演算子、二項演算子、三項演算子の前後
* 単項演算子とオペランドの間にはスペースを入れない。
* []、->、ピリオド(.)、コンマ(,)は除き、 二項演算子、三項演算子の前後には1スペースを入れる。

```cpp
    // @@@ example/etc/coding_style.cpp #7:0 begin -1
```

### 不要なブランク文字
* スペース文字は、セパレータとして適切に使用するためのものである。
  従って、行末に不要なブランクキャラクタを置かない。
* ファイル末に不要な改行を入れない。

## 三項演算子のスタイル
* 三項演算子は以下のように書く。

```cpp
    // @@@ example/etc/coding_style.cpp #8:0 begin -1
```

* 以下のような表記方法も認められる。この表記は、switch文やif-else-if文と同様に使える。

```cpp
    // @@@ example/etc/coding_style.cpp #8:1 begin -1
```

## ポインタ型やリファレンス型インスタンスの宣言、定義の\*や&の場所
* ポインタ型やリファレンス型インスタンスの宣言、定義の\*や&は型の直後に配置する。

```cpp
    // @@@ example/etc/coding_style.cpp #9:0 begin -1
```

* 一つの文で複数の変数の定義をしない。

```cpp
    // @@@ example/etc/coding_style.cpp #9:1 begin -1
```

## 行数・桁数
### 関数の行数

* 関数の行数({から}の間)は30行までに収める。
* 「テストシーケンスを一つの関数に押し込める」という方法は一般的なため、
  単体テストのための関数に対しては、この制限を適用しない。

### 行のカラム数
* 1行の最長は コメントを含めて100カラムとする。100カラムを超える行は、適切な位置に改行を入れる。
* 以下に100カラムを超える行のスタイルを例示する(縦にそろえることを重要視する)。

    * 関数の宣言

    ```.cpp
            // @@@ example/etc/coding_style.cpp #10:0 begin
    ```

    * 定義を伴う関数の宣言

    ```.cpp
            // @@@ example/etc/coding_style.cpp #10:1 begin
    ```

    * 関数呼び出し

    ```.cpp
            // @@@ example/etc/coding_style.cpp #10:2 begin -1
    ```

    * 論理演算子は行末ではなく、行頭に配置(行中にあってもよい)

    ```.cpp
            // @@@ example/etc/coding_style.cpp #10:3 begin -1
    ```

    * 代入の'='の前で改行し、'='を行頭に持ってくる。 

    ```.cpp
            // @@@ example/etc/coding_style.cpp #10:4 begin -1
    ```

    * 長い文字列

    ```.cpp
            // @@@ example/etc/coding_style.cpp #10:5 begin -1
    ```

## ブロックの論理レベル
* 各ブロックの抽象度を揃える。

```cpp
    // @@@ example/etc/coding_style.cpp #11:0 begin
```

## 名前空間
* 一般に名前空間定義の区間は縦に長いため、
  最後に必ず名前空間の終わりであることを示すためのコメントを記述する。
* ネストが深くなりすぎるため、名前空間用のインデントはしない。

```cpp
    // @@@ example/etc/coding_style.cpp #12:0 begin
```

## clang-format
参考のために、サンプルソースコードに適用している.clang-formatを例示する。

```
    // @@@ .clang-format #0:0 begin
```


